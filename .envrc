#!/usr/bin/env bash
# Direnv configuration for automatic Nix environment loading
#
# This file enables automatic environment activation when entering the directory.
# Make sure you have direnv installed and hooked into your shell.
#
# To allow this file, run: direnv allow

# Use flake-based development environment
if [ -f flake.nix ]; then
  # Default to development shell, can override with NIXSHELL env var
  # Examples:
  #   export NIXSHELL=personal  # For personal desktop apps
  #   export NIXSHELL=minimal   # For minimal environment
  use flake .#${NIXSHELL:-default}
else
  # Fallback to traditional shell.nix if flake doesn't exist
  use nix
fi

# Project-specific environment variables
export PROJECT_ROOT="$PWD"

# Python/Conda setup (if conda is installed)
if [ -d "$HOME/miniconda3" ]; then
  source "$HOME/miniconda3/etc/profile.d/conda.sh"
fi

# Load local environment overrides if they exist
if [ -f .envrc.local ]; then
  source .envrc.local
fi